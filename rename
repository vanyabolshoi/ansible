---
- name: Переименование Windows-машин по порядку
  hosts: windows
  gather_facts: no
  vars:
    prefix: "PC"
    start_number: 201

  tasks:
    - name: Переименовать компьютер по порядку
      ansible.windows.win_hostname:
        name: "{{ prefix }}{{ start_number + loop.index0 }}"
      loop: "{{ query('inventory_hostnames', 'windows') }}"
      loop_control:
        label: "{{ item }}"

    - name: Перезагрузить машину после переименования
      ansible.windows.win_reboot:
        msg: "Перезагрузка после переименования"
        reboot_timeout: 600
