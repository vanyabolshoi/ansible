---
- name: Get last modification date of user folders
  hosts: windows
  gather_facts: no

  tasks:

    - name: Get last modification date of user folders
      win_shell: |
        Get-ChildItem C:\Users -Directory |
        Where-Object {
            $_.Name -notin @("Public","Default","Default User","All Users")
        } |
        Select-Object FullName, LastWriteTime |
        Sort-Object LastWriteTime -Descending
      register: user_dates

    - name: Show result
      debug:
        var: user_dates.stdout_lines
