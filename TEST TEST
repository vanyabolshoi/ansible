---
- name: Проверка доступности WinRM на Windows-хостах
  hosts: windows
  gather_facts: no

  tasks:
    - name: Проверка WinRM - выполнить hostname
      win_command: hostname
      register: winrm_result
      ignore_errors: yes

    - name: Вывести статус узла
      debug:
        msg: >
          {{ inventory_hostname }}: {{
            'WinRM доступен' if not winrm_result.failed else 'WinRM недоступен или ошибка' }}
